<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>JS</title>
    <link rel="stylesheet" type="text/css" href="./index.css" />
    <link rel="stylesheet" type="text/css" href="./style/button.css" />
    <link rel="stylesheet" type="text/css" href="./style/navbar.css" />
    <link rel="stylesheet" type="text/css" href="./style/home.css" />
    <link
      href="https://unpkg.com/tailwindcss@^2/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css"
    />

    <script type="module" src="./index.js"></script>
    

    <style>
    </style>
  </head>
  <body>
    <section class="nav-container">
      <nav>
        <a href="#">Home</a>
        <a href="#">About</a>
        <a href="#">Blog</a>
        <a href="#">Portefolio</a>
        <a href="/contact-us.html">Contact</a>
        <a href="#" type="button" id="logout" class="logout">Log Out</a>
        <div class="animation start-home"></div>
      </nav>
    </section>

    <section class="main-section">
        <section class="svg-container" id="svg-container">
            <section class="space">
                <div class="space-boy" id="space-boy">
                    <img src="/asset/astro-boy.png" alt="">
                </div>
            </section>
            <div class="svg-container-img">
                <!-- <div class="space-boy ">
                    <img src="/asset/astro-boy.png" alt="">
                </div> -->
            </div>
            <svg view-box="0 0 500 160">
              <g>
                <path
                  id="label1"
                  class="s"
                  d="M452,408h-56c-4.42,0-8-3.58-8-8l0,0c0-4.42,3.58-8,8-8h56c4.42,0,8,3.58,8,8l0,0     C460,404.42,456.42,408,452,408z"
                />
                <text
                  x="50%"
                  y="40%"
                  dy=".32rem"
                  text-anchor="middle"
                  class="text-body"
                >
                  Welcome!!!
                </text>
              </g>
            </svg>
      
            <!-- <h1 id="hello" class="text-primary">hello</h1> -->
      
            
    </section>

    <section class="flex justify-center magnetic-items good">
        <div class="goodOne flex">
            <button class="magneto mr-4">
                <span class="magneto-text ">
                    Our text
                </span>
            </button>
            <button class="magneto mr-4">
                <span class="magneto-text ">
                    Our text
                </span>
            </button>
        </div>
        <div class="goodTwo flex">
            <button class="magneto mr-4">
                <span class="magneto-text ">
                    Our text
                </span>
            </button>
            <button class="magneto">
                <span class="magneto-text">
                    Our text
                </span>
            </button>
        </div>
        <div id="debugger"></div>
      </section>
    </section>

    <!-- Lenes scroll -->
    <section class="cont-scroller">
        <div class="cont entry">
            <div class="cont-1 entry__meta">skdnfkjn</div>
            <div class="cont-2 entry__media">
                hello
            </div>
        </div>

        <div class="cont entry mt-6">
            <div class="cont-1 entry__meta">skdnfkjn</div>
            <div class="cont-2 entry__media">
                hello
            </div>
        </div>
    </section>

    <!-- horizintal scroll -->
    <section id="panels">
        <div id="panels-container" style="width: 500%">
          <article id="panel-1" class="panel full-screen red">
              <h2>Panel 1</h2>
          </article>
          <article id="panel-2" class="panel full-screen orange">
              <h2>Panel 2</h2>
          </article>
          <article id="panel-3" class="panel full-screen purple">
              <h2>Panel 3</h2>
          </article>
          <article id="panel-4" class="panel full-screen green">
              <h2>Panel 4</h2>
          </article>
          <article id="panel-5" class="panel full-screen gray">
              <h2>Panel 5</h2>
          </article>
        </div>
      </section>

      <section id="map" class="full-screen"></section>



  </body>

<!-- Script -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/gsap.min.js"></script>
<!-- Scroll animation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.4/ScrollTrigger.min.js"></script>
<script src="https://unpkg.com/@studio-freight/lenis@1.0.33/dist/lenis.min.js"></script>






  <script type="module">
    
    let userInfo = JSON.parse(sessionStorage.getItem("userInfo"));
    let userCred =JSON.parse(sessionStorage.getItem("userCred"));

    const logoutButton = document.getElementById('logout');
    const userName = userInfo?.name;


    logoutButton.addEventListener("click", () => {
      sessionStorage.removeItem("userInfo");
      sessionStorage.removeItem("userCred");
      window.location.href = "/login-form.html";
    });

    //user Name in Svg
    let label1 = document.querySelector("#label1");

    addLabelText(label1, `${userName}`);

    function addLabelText(bgPath, labelText) {
      let bbox = bgPath.getBBox();
    //   let x = 50;
    //   let y = 70;

      // Create a <text> element
      let textElem = document.createElementNS(bgPath.namespaceURI, "text");
      textElem.setAttribute("x", "50%");
      textElem.setAttribute("y", "70%");
      // Centre text horizontally at x,y
      textElem.setAttribute("text-anchor", "middle");
      // Give it a class that will determine the text size, colour, etc
      textElem.classList.add("text-body");
      // Set the text
      textElem.textContent = labelText;
      // Add this text element directly after the label background path
      bgPath.after(textElem);
    }
  </script>

  <!-- magneto -->
  <script>
    // const magneto = document.querySelector('.magneto');
    // const magnetoText = document.querySelector('.magneto-text');
    const dbgr = document.querySelector('#debugger');   

    const allMagneto = document.querySelectorAll('.magneto');
    // console.log(allMagneto)

    allMagneto.forEach( magnetButton => {

        // let magneto = magnetButton.querySelectorAll('.magneto');
        let magnetoText = magnetButton.querySelectorAll('.magneto-text');

        // console.log(magneto);


        //mouse move stuff
        let activateMagneto = (event) => {
            //get position of the element(magneto) along with h and w
            
            let boundBox = magnetButton.getBoundingClientRect();
            const magnetoStrength = 40;
            const magnetoTextStrength = 80;

            const newX = ((event.clientX - boundBox.left)/ magnetButton.offsetWidth) - 0.5;
            const newY = ((event.clientY - boundBox.top)/ magnetButton.offsetHeight) - 0.5;

            //move button new position
            gsap.to(magnetButton, {
                duration: 1,
                x: newX * magnetoStrength,
                y: newY * magnetoStrength,
                ease: Power4.easeOut
            });
            //move button text new position
            gsap.to(magnetoText, {
                duration: 1,
                x: newX * magnetoTextStrength,
                y: newY * magnetoTextStrength,
                ease: Power4.easeOut
            });

            dbgr.innerHTML = 'cursorX: ' + event.clientX
                            + '<br> boxLeft: ' + Math.ceil(boundBox.left)
                            + '<br> CursorInsideButton: ' + Math.ceil(event.clientX - boundBox.left)
                            + '<br> relative to total width: ' + ((event.clientX - boundBox.left)/ magnetButton.offsetWidth).toFixed(2)
                            + '<br> shifted: ' + ((event.clientX - boundBox.left)/ magnetButton.offsetWidth - 0.5).toFixed(2)
        }

        //mouse leave action

        const resetMagneto = (event) => {

            //move button new position
            gsap.to(magnetButton, {
                duration: 1,
                x: 0,
                y: 0,
                ease: Power4.easeOut
            });
            //move button text new position
            gsap.to(magnetoText, {
                duration: 1,
                x: 0,
                y: 0,
                ease: Power4.easeOut
            });

        
     }

     magnetButton.addEventListener('mousemove', activateMagneto);
     magnetButton.addEventListener('mouseleave', resetMagneto);

    });


   
    // magneto.addEventListener('mousemove', activateMagneto);
    // magneto.addEventListener('mouseleave', resetMagneto);
  </script>

<!-- Lenes smooth Srolling -->
<script>

        const entries = document.querySelectorAll('.entry');
        
        entries.forEach(entry => {
            let entryMeta = entry.querySelectorAll('.entry__meta');
            let entryMedia = entry.querySelectorAll('.entry__media');

            // gsap.set(entryMeta, {
            //     xPercent: -100,
            //     opacity: 0
            // });
            // gsap.set(entryMedia, {
            //     xPercent: 100,
            //     opacity: 0
            // });

            // gsap.to(entryMeta, {
            //     scrollTrigger: {
            //         trigger: entry,
            //         start: 'top bottom',
            //         end: 'bottom 90%',
            //         markers: true,
            //         scrub : true
            //     },
            //     xPercent: 0,
            //     opacity: 1
            // });

            // gsap.to(entryMedia, {
            //     scrollTrigger: {
            //         trigger: entry,
            //         start: 'top bottom',
            //         end: 'bottom 90%',
            //         markers: true,
            //         scrub : true
            //     },
            //     xPercent: 0,
            //     opacity: 1
            // });

            let tl = gsap.timeline({
                scrollTrigger: {
                    trigger: entry,
                    start : 'top bottom',
                    end: 'bottom 100%',
                    scrub : true,
                    // markers: true,
                }
            });
            
            tl.fromTo(entryMeta, { xPercent:-110, opacity: 0 },{ xPercent:0, opacity: 1 });
            tl.fromTo(entryMedia, { xPercent:100, opacity: 0 },{ xPercent:0, opacity: 1 },'<');

        });

        const buttonLeft = document.querySelectorAll('.goodOne');
        const buttonRight = document.querySelectorAll('.goodTwo');
       
        // buttonGood.forEach(entry => {
        //     let entryOne = entry.querySelectorAll('.goodOne');
        //     let entryTwo = entry.querySelectorAll('.goodTwo');


        //     let tl = gsap.timeline({
        //         scrollTrigger: {
        //             trigger: entry,
        //             start : 'top bottom',
        //             end: 'bottom 100%',
        //             scrub : true,
        //             // markers: true,
        //         }
        //     });
        // })
        gsap.set(buttonLeft, {
                xPercent: 0,
                yPercent: 0,
                opacity: 1
            });

            gsap.to(buttonLeft, {
                scrollTrigger: {
                    trigger: buttonLeft,
                    start: 'top 50%',
                    end: 'bottom top',
                    scrub : true,
                    reverse: 0
                },
                xPercent: -300,
                yPercent: 100,
                opacity: 0
            });


            gsap.set(buttonRight, {
                xPercent: 0,
                yPercent: 0,
                opacity: 1
            });

            gsap.to(buttonRight, {
                scrollTrigger: {
                    trigger: buttonRight,
                    start: 'top 50%',
                    end: 'bottom top',
                    scrub : true,
                    reverse: 0
                },
                xPercent: 300,
                yPercent: 100,
                opacity: 0
            });

            
            // const contactInfo = document.querySelectorAll(".contact-container");

            // gsap.set(contactInfo, {
            //     xPercent: 100,
            //     // yPercent: 0,
            //     opacity: 0.5
            // });

            // gsap.to(contactInfo, {
            //     scrollTrigger: {
            //         trigger: contactInfo,
            //         start: 'top bottom',
            //         end: 'bottom 90%',
            //         scrub : true,
            //         reverse: 0
            //     },
            //     xPercent: 0,
            //     // yPercent: 100,
            //     opacity: 1
            // });

            const sections = document.querySelectorAll(".contact-child");
            const contactContainer = document.querySelectorAll(".contact-container");
            // let sections = gsap.utils.toArray(".panel");
            entries.forEach(sections => {
                gsap.to(sections, {
                xPercent: -100 * (sections.length - 1),
                ease: "none",
                scrollTrigger: {
                    trigger: contactContainer,
                    pin: true,
                    scrub: 1,
                    snap: 1 / (sections.length - 1),
                    end: () => "+=" + document.querySelectorAll(".contact-container").offsetWidth
  }
});
            })

        const lenis = new Lenis()

        lenis.on('scroll', ScrollTrigger.update)

        gsap.ticker.add((time)=>{
        lenis.raf(time * 1000)
        })

        gsap.ticker.lagSmoothing(0)
</script>

 <!-- horizontal scroll -->
 <script>
    /* Main navigation */
    let panelsSection = document.querySelector("#panels"),
      panelsContainer = document.querySelector("#panels-container");

    /* Panels */
    const panels = gsap.utils.toArray("#panels-container .panel");
    tween = gsap.to(panels, {
      // xPercent: -100 * ( panels.length - 1 ),
      x: () => -1 * (panelsContainer.scrollWidth - innerWidth),
      ease: "none",
      scrollTrigger: {
        trigger: "#panels-container",
        pin: true,
        start: "top top",
        scrub: 1,
        // snap: {
        //  snapTo: 1 / (panels.length - 1),
        //  inertia: false,
        //  duration: {min: 0.1, max: 0.1}
        // },
        end: () => "+=" + (panelsContainer.scrollWidth - innerWidth),
      },
    });
  </script>


<!-- space -->
<script>  
        const space = document.getElementById('svg-container');
        const boy = document.getElementById('space-boy');
        // const boyLocation = Math.ceil(boy.getBoundingClientRect().left);

        let boundBox = space.getBoundingClientRect();
        

        // console.log(boyLocation)

        //mouse move stuff
        let activateSpace = (event) => {
            let boundBox = space.getBoundingClientRect();
            const magnetoStrength = 40;
            const magnetoTextStrength = 80;

            const newX = ((event.clientX - boundBox.left)/ space.offsetWidth) - 0.5;
            const newY = ((event.clientY - boundBox.top)/ space.offsetHeight) - 0.5;

            //move button new position
            gsap.to(space, {
                duration: 1,
                x: newX * 10,
                y: newY * 10,
                ease: Power1.easeOut
            });
            //move button text new position
            gsap.to(boy, {
                duration: 5,
                x: newX * magnetoTextStrength * 20,
                y: newY * magnetoTextStrength * 6,
                ease: Power4.easeOut
            });
            // boy.classList.remove("bounce");

            // newBoyLocation();
            
        
        }
        //mouse leave action

        const resetSpace = (event) => {

            //move button new position
            gsap.to(space, {
                duration: 4,
                x: 0,
                y: 0,
                ease: Power4.easeOut
            });
            //move button text new position
            gsap.to(boy, {
                duration: 1,
                x: 0,
                y: 0,
                ease: Power4.easeOut
            }); 
            
            // setInterval(function() {
                    // boy.classList.add("bounce");
            //     }, 4500);
            
            // console.log(Math.ceil(boy.getBoundingClientRect().left))

            // newBoyLocation();
            // if(boy.getBoundingClientRect().left === boyLocation) {
            //     console.log('same');
            // }

           

        
     }

    //  function newBoyLocation() {
    //     console.log(Math.ceil(boy.getBoundingClientRect().left))
    //  }
    // boy.classList.add("bounce");
     space.addEventListener('mousemove', activateSpace);
    //  space.addEventListener('mouseleave', resetSpace);
    // space.addEventListener('mouseleave', ()=>{boy.classList.add("bounce");});

  </script>
</html>
